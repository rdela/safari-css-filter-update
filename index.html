<!doctype html><html><head><meta charset="utf-8">
	<title>Safari/WebKit CSS Filter Update Bug</title>
	<meta name="viewport" content="width=device-width">
	<style type="text/css">
		body { font-family: system-ui; }
		h1 { font-size: 1.5rem }
		p { font-size: 1.375rem;}
		button {
			filter: grayscale(100%);
			font-size: 2rem;
			margin-right: 0.375rem;
			padding: 0.5rem 1rem;
		}
		button[aria-selected='true'] {
			filter: grayscale(0%);
		}
	</style>
</head><body>
	<h1>Safari/WebKit CSS Filter Update Bug</h1>
	<button aria-selected="true">ðŸ™‚</button>
	<button aria-selected="false">ðŸ™ƒ</button>
	<p>Open Web Inspector and watch the buttons aria-selected attributes values change while clicking them. Observe how the CSS filter [grayscale(100%) unless aria-selected is true, then 0%] is not applied consistently when the values change. Try the same in Chromium and Firefox browsers. Oddly, in Safari, display only seems to update to the correct value when window focus changes or when Web Inspector is opened or closed.</p>
	<script type="text/javascript">
		const buttons = document.querySelectorAll("button");
		console.dir(buttons);

		buttons.forEach((button) => {
			button.addEventListener("click", () => {
				console.log(button);
				if (button.getAttribute("aria-selected") == "true") {
					button.setAttribute("aria-selected", "false");
				} else {
					button.setAttribute("aria-selected", "true");
				}
			});
		});
	</script>
</body></html>
